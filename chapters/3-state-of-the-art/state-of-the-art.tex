\chapter{State-of-the-art} % about 20-30 pages
\chaptermark{State-of-the-art of comic books analysis}
\label{chap:sota}
\graphicspath{{./chapters/3-state-of-the-art/figs/}}

% This thesis work has considered symbol spotting problem as an application of subgraph matching. Symbol spotting has experienced a lot of interests among the graphics recognition community. Here the main task starts by querying a given graphic symbol or model object, usually cropped from a bigger document. The main aim is to search the model object in a target document or set of target documents. In this dissertation we will alternatively name the model object to be queried as \emph{model symbol} or \emph{query symbol} or \emph{pattern} and the corresponding graph representing them as \emph{query graph} or \emph{model graph} or \emph{pattern graph}. And the document or the set of documents where the user intends to find the model symbol as \emph{input document} or \emph{target document} and the corresponding graph as \emph{target graph} or \emph{input graph}. Most of the time the user is interested in getting a ranked list of retrieved zones supposed to contain the queried symbol depending on the similarity or dissimilarity measure. This Chapter contains a review of the state-of-the-art of symbol spotting methods. The major existing research can be classified into five broad families as in~\cite{RusinolThesis2009}, which are listed in Table~\ref{table:sota-ss:relworks}. We review those families as follows:

Comics images are mixed content documents that are processed differently depending on the purpose.
The involved techniques can vary a lot between panel, balloon, text and comic character extractions.
The contents of different nature are related to each other to produce a story.
Treating each of the content separately has a limit that can be exceeded in a holistic understanding approach by reaching a higher semantic level.
We review specific comics image content processing, holistic understanding of images and the existing applications in this section.

\section{Panel extraction and layout analysis}
\label{sec:sota:layout_panel}


Panel extraction and ordering has been mainly studied for panel to panel reading.
The need is increasing since the first generation of mobile devices with small screens in colour or B\&W.
People want to continue reading their favourite comics or manga on the way without caring kilos of books.
Printed comics require tedious work to be manually scanned and split into screen size parts small enough to avoid zooming and scrolling.

Several techniques have been proposed to automatically extract panels as~\cite{In11}, assuming that panels are small enough elements to be comfortably read on mobile devices.
They are based on white line cutting algorithm~\cite{Duda72,li2012automatic,Chan2007Automatic}, recursive X-Y cut~\cite{Han07} or gradient~\cite{Tan07}.
Those methods do not consider empty area~\cite{In11} and border free panel.
These issues have been corrected by connected component approaches~\cite{Arai10} 
%,Rigaud2012LNCS} 
but they are sensible to region that sometimes connect several panels and increase the detection error rate.
Another approach based on morphological mathematics and growing region~\cite{Khoi11} can remove such connecting elements but also create new holes in the panel border.
After the region segmentation step, heuristic filtering is often applied~\cite{Arai11,Khoi11} to classify panel region according to the size ratio with the page which depends on the page format.
More recently, new method have shown interesting results for manga and European comics with different background colours.
They are based on watershed~\cite{ponsard2012ocr}, line segmentation using Canny operator and polygon detection~\cite{Luyuan2014Automatic}, and region of interest detection~\cite{stommel2012segmentation} such as corners~\cite{Tsai2013Adaptive} and line segments.
Panel retargeting have been addressed for manga by Matsui~\cite{Matsui2011}.

Page layout analysis have been recently studied to calculate the reading order of the panels.
The page layout influences the reader at choosing pathway~\cite{Cohn_2013}, nevertheless few studies~\cite{Guerin2012Ontologies,Ponsard09,Arai2010Automatic} demonstrated the possibility of calculating such Z-path (left-to-right and down) or right-to-left (e.g. Arabic, Japanese) and down~\cite{Li2013Comic,Tsai2013Adaptive} according to the position of the panels. 

\section{Balloon segmentation and tail detection}
\label{sec:sota:balloon_segmentation}

Balloons or bubbles are the visual unit that conveys dialogue, either spoken or thought.
Balloons have developed into a more-or-less oval shape, with a pointer or tail to indicate to which character they belong.
There are many specialized forms of balloons, either traditional or invented~\cite{Marx2006Writing}.
%Balloons or bubbles are key elements in comics, they link graphical and textual elements and are part of the comics style. 
Few work about balloon detection have been done until now and mainly closed speech balloon have been studied.
Arai~\cite{Arai11} proposed a blob detection method based on connected component detection with four filtering rules for manga.
The rules are based on blob minimum size, white pixel occurrence, inclusion of vertical straight lines detection and width to length ratio (see figure~\ref{fig:Arai_balloon_extraction_process}).
Another connected component approach proposed by Ho~\cite{Ho2012} uses HSV color space to make a first selection of clear blobs and then consider as balloons the blobs with a ratio between the text area and the blob bounding box higher than sixty percent.

From our knowledge, the analysis of open balloons, balloon contour and tails have not been studied before, we propose a first approaches in~\ch{chap:be}.
Those extra information about the balloons are important for a broad understanding of the dialogues and emotions~\cite{millidge2009comic}.

% chapter chap_be (end) ~\ref{sub:be:segmentation}.

%We proposed a first method to extract non closed balloons based on active contours initialized around text areas~\cite{rigaud2013active}, see section~\ref{sub:be:segmentation}.
% This method is able to approximate the contour region, even when it is not printed, based on a domain knowledge which is the mean distance between the balloon contour and the text it contains. 

% A balloon is a spatial container of information that is related to a protagonist using a specific element: the tail.
% The tail is often represented by a discontinuity on contour of the balloon towards the concerned protagonist.
% From our knowledge, there is no work about tail extraction and description in the literature.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 \begin{figure}[!ht]  %trim=l b r t  width=0.5\textwidth,
   \centering
  \includegraphics[trim= 0px 0px 0px 0px, clip, width=150px]{figs/Arai_balloon_extraction_process.pdf}
  \caption{Flow diagram of comic balloon detection using comic blob extraction method proposed by Arai~\cite{Arai11}.}
  \label{fig:Arai_balloon_extraction_process}
 \end{figure}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\section{Text extraction and recognition}
\label{sec:sota:text}

% \begin{itemize}
% 	\item \url{/Text_graphic_separation/2002_Bernhaupt_Using ArtificialNeuralNetwork as image segmentation : application on comics} 
% \end{itemize}


Text extraction and recognition have attracted of lot a attention in document analysis such as newspaper, administrative documents, cheques, maps, floor plans and engineering drawings. 
Nevertheless, the most similar application to comics is car plate recognition~\cite{anagnostopoulos2008license} because the text is in a salient and contrasted area with a complex background around it.
% Nevertheless, plates are typewritten with a fixed length.

%From our knowledge, only text localization has been studied, no text segmentation or text recognition yet. This is probably due to the lack of dataset and ground truth to evaluate the algorithms.
Few work concerns text in comics images, bottom-up approaches use connected component which often relies on the segmentation step~\cite{ponsard2012ocr}.
Su~\cite{Su11} uses Sliding Concentric Windows as text/graphic separation and then apply mathematical morphology and an SVM classifier to classify text from non-text components. 
%Morphological operations are performed with a fixed mask size, the method is orientation and resolution dependent.

% In~\cite{Rigaud2013VISAPP}, we proposed a adaptive binarisation process based on the Minimum Connected Component Thresholding followed by a text/graphic separation based on contrast ratio and text line grouping, see~\ch{chap:te}.
% Previously, we proposed a k-mean classification of the 
Li~\cite{Li2013Unsupervised} proposed an unsupervised speech text localization for comics that trains a Bayesian classifier on aligned connected component and then detect the rest of the text using the classifier for text/non text separation.
 

% Rigaud~\cite{Rigaud12} %~\cite{Rigaud12}
% make use of ``the median value of the border page pixels'' to binarize the image, extract CC and then classify them into ``noise'', ``text'' or ``frame'' (based on CC heights). This method assumes that the page always contains text and that the text background colour is similar to the paper background. 

Top-down approaches starting from balloons (white blobs) detection followed by mathematical morphology operations have been proposed by Arai~\cite{Arai11} and Yamada~\cite{Yam04} and Sundaresan~\cite{Sundaresan2012Text}.



\section{Comic character detection}
\label{sec:sota:comic_character}

% \begin{itemize}
	% \item Garfield character detector based on color histogram \url{/PhD/Biblio_LINK/Object_detection2013_Landry_Color Based Comic Strip Character Recognition.pdf}
	% \item \url{2011_Matsui_Interactive manga retargeting - siggraph11.pdf}
	% \item \url{object/2012_Takayama_FACE DETECTION AND FACE RECOGNITION OF CARTOON CHARACTERS USING FEATURE EXTRACTION}
	% \item \url{object/2007_MASTER_Cheung_Face detection and face recognition of human-like characters in comics}
	% \item Stoke images \url{Object_detection/2010_THESIS_Ta_phuong_inexact_graph_matching_application_to_stroke_images_comics.pdf}
% \end{itemize}


Human detection in computer vision field has been largely studied during the past decades, mainly based on grayscale image and gradients. Color information is rarely relevant for human detection because of clothing and skin color difference. In videos, moving regions are often used as region of interest.

Although, comics are often a reproduction of human life situations, they are a domain where we can not directly apply human detection based methods.
The main difference is that comic characters (e.g. protagonist, hero) are hand drawn and therefore more variant in terms of deformation, shape and appearance than real life humans (see fig.~\ref{fig:tarzan}).
% Comics are composed by a sequence of static snapshots telling a story like a video at a very low frame rate, where we want to detect similar objects. 
In colored comics, the color information gives the identity of characters and plays a main role for character spotting with speech balloon positions. 
The simplistic character design allows for easy identification and representation and goes along with how human process visual information~\cite{ahmadimpactsOfManga,medley2010discerningPictures,cohn2010limits}.
%Comics characters are often described using colors while human are described using head feature (e.g. brown hair, blue eyes) because it is the only part that does not change in every day life. 
This is a big difference compared to natural images and human detection, since comics are designed in a way that the information (e.g where are the comic characters, who is talking, where is it going) can be quickly found.% Famous people also use this technique to be easily recognize in video show for example (professional identity).

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 \begin{figure}[!ht]	%trim=l b r t  width=0.5\textwidth,
 	 \centering
 	\includegraphics[width=220px]{figs/prunelle.png}
 	\caption{Examples of comics character postures. This example shows deformation, pose, rotation, translation and occlusion variations. Image credits: Prunelle, la fille du cyclope, Vicky Portail-Kernel and C\'{e}dric Kernel, Ankama, 2010.
}
 	\label{fig:tarzan}
 \end{figure}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Recent studies have been published for partial Manga copy detection~\cite{Sun2010}, mainly based on shape information because of the absence of color information.
This work has been extended to Manga copyright infringement protection~\cite{Sun2013IJDAR} using a face detector~\cite{Viola2004robust} as seeds and concentric HOG~\cite{Dalal05} descriptor.
This work shows good results for manga part retrieval which is a subset of the whole comics world.
% In our work we focus on a complementary subset, corresponding to colored comics analysis.

Colored comics may be compared to cartoon images sequence, for which a first work based on HOG, SVM and color attributes has been published in 2012~\cite{Khan12}.
Preliminary work about cartoon and comics faces recognition have been carried out by Kohei~\cite{Kohei2012} and Cheung~\cite{cheung2008face}.
Recently, graph theory has been used to find redundant color structure in order to automatically localize the most frequent color group apparition and label them as main characters~\cite{HoGREC2013}.
The thesis of TA~\cite{TAPhD2010} (section 1.1 and 1.2) gives a good overview about hand drawing recognition and mentions that ``story board scene understanding still remains an open problem, few results are available in the literature about stroke images''.
Another work uses HOG descriptor with redundant information classification to also find the most frequent elements~\cite{SunICDAR2013}.
Both graph and descriptor based methods need an image preprocessing step to remove unwanted redundant elements such as text and speech balloons.

Interesting approaches tries to automatize comic generation~\cite{Tobita2010Comic,WangHYYC12} using image cartoonification and script analysis.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%ù

% Human body and face extractions in real scene image have progressed a lot during the last decades. 
% Nevertheless, the few studies that are related to comics shown that human detection techniques are not appropriate for comics character or need to be trained for specific comic types.
% Those studies concerns the fraud detection in mangas~\cite{Sun2013IJDAR}, cartoon classification~\cite{Khan12} and the detection of the main characters using redundancy information~\cite{SunICDAR2013,HoGREC2013}.
% Preliminary work about cartoon and comics faces recognition have been carried out by Kohei~\cite{Kohei2012} and Cheung~\cite{cheung2008face}.

%We recently proposed~\cite{RigaudDAS2014} a query by example approach that ask the user to select a part of the object he is looking for in one comics image and the system retrieves it automatically everywhere in all the pages of the comics album, assuming that they have been digitized under the same conditions.


\section{Holistic understanding} % (fold)
\label{sec:sota:holistic_understanding}

One of the original goals of image or graphical document analysis was to fully understand the content of any image~\cite{Lamiroy2014Handbook}.
This requires solving several sub-tasks simultaneously, for instance region detection, labeling of meaningful regions and semantic understanding using layout analysis.
In the past, researchers have developed classifiers for tackling each of these sub-tasks independently~\cite{Mao2003Document}.
However, these sub-tasks can help each other.
For instance, in a comics page, if we know the panel positions, then we make a better guess at the location of the comics characters (they are usually in the panels).
It is not easy to combine different related sub-tasks together.
Previous work concern real scene image analysis~\cite{Blaschke2014Geographic}, retrieval~\cite{Sciascio2011Structured} and understanding~\cite{Li2012Toward,Fidler2012Describing}, medical image annotation using description logic and inference engine~\cite{Hu2003Ontology}, object-based image retrieval~\cite{Mezaris03anontology,Sarwar2013Ontology} (between keyword-based and query-by-example) and image interpretation~\cite{Hudelot2008Fuzzy,Ogier2000Semantic} that mentions the importance of using topological information, distances, directional relative position and much complex relations such as ``between'' and ``surround'' and ``among''.
Also, Geographic Object-Based Image Analysis (GEOBIA)~\cite{Blaschke2014Geographic} makes extensive use of ontologies to interpret the maps.

%{\bf ADD} background about document understanding and drawing retrieval (OK: cadastral map).

Recently, images from comic books have been also considered.
An ontology of comics has been proposed from a philosophical approach~\cite{Aaron2011}, a semantic annotation tool~\cite{Hermann2012Guided} makes use of previous knowledge and consistency information to suggest new knowledge to the user in a interactive way.
Spatial inferences have been used to infer the comic books reading order, for panel in the page and balloon in the panel~\cite{Guerin2012Ontologies}. 
In~\cite{Sciascio2011Structured}, they highlight the benefit of using contextual information of simple object to build more complex ones.
% From our knowledge, there is no framework for document understanding in the literature that infers new knowledge iteratively and without user interaction (unsupervised).

% section holistic_understanding (end)

\section{Existing applications}
\label{sec:sota:applications}

% \begin{itemize}
	% \item Voice + comic: people tell the comic story and sell them \url{http://vomic.shueisha.co.jp/}
	% \item Comic Chat is a working program, allowing groups of people to communicate over the Internet see \url{2006_Kurlander_Comic_Chat.pdf}
	% \item \url{2010_Tobita_Comic Engine: Interactive System for Creating and Browsing Comic books with Attention Cuing.pdf}
	% \item Comic life: turning your photos into a comic \url{http://plasq.com/}
	% \item Online interactive creation of comics \url{2009_Lopes_Calligraphic Shortcuts for Comics Creation.pdf}

	% \item Software for scripting comics, to define the interactions, time, zoom and region for a kind of video export \url{2012_Raulet_A Sketch-based Interface to Script Comics Reading.pdf}

	% \item Movie to comics: ... the first three factors determine balloon size, and the last factor determines balloon shape ... Emotion can be further exhibited by shape of balloon [1] \url{/PhD/Biblio_LINK/Speech_balloon_analysis/2013_Chu_Optimized Speech Balloon Placement for Automatic_comics_generation.pdf}
% 	\item OCR Manga Reader \url{https://play.google.com/store/apps/details?id=com.cb4960.ocrmr&hl=en}
% 	\item Capture2Text \url{http://capture2text.sourceforge.net/}
% \end{itemize}


Comic books are a graphic art form combining text and images to tell a story.
Comics are now used in a wide variety of styles, not only on paper (e.g., magazines, newspapers, TV show) but also as electronic content (smartphone apps, e-books, websites).
Comics are one of the most popular and familiar forms of graphic content.
People read comics easily and learn many things, so even children can learn about cultures and trends, among other things, through comics even unconsciously.

From this background, we can divide comic-based computer systems into two categories.
One type would be using comics to represent complex information such as online communication in a form of comics~\cite{Kurlander1996} and generating video or story log summaries~\cite{Uchihashi1999Video,Alves2008So,Shamir2006Generating} (computer graphics domain).
Also, it is possible to listen at manga~\cite{Vomic} which have been recorded by people reading the story or used app for automatic translation~\cite{OCRMangaReader,Capture2Text} (requires user text selection).
These systems are useful to add value to the content while making it more funny and interesting.
The other category concerns the comic design by enabling novices to create comics  interactively using a computer for augmenting an individual user's memory~\cite{SumiSNM2002Comic}, turning photo albums into a comic~\cite{ComicLife3}, making comic-like video~\cite{Raulet2011Sketch}, making collaborative comics~\cite{Ricardo2009Calligraphic} and exchanging rich message~\cite{Salovaara2007Appropriation}.




\section{Conclusion}
\label{sec:sota:conclusion}


\begin{itemize}
	% \item Copy/paste from previous publications
	\item Demonstrate that I understand the topic
	\item Conclusion and critics
	\item From our knowledge, there is no framework for document understanding in the literature that infers new knowledge iteratively and without user interaction (unsupervised).

	% \item Navigating comics: an empirical and theoretical approach to strategies of reading comic page layouts \url{2013_Cohn_navigating_comics.pdf}
	% \item 2013 SIGRAPP poster \url{2013_Tsai_Adaptive Manga Re-Layout On Mobile Device.pdf}
\end{itemize}

To conclude the literature review, some of the challenges of symbol spotting can be highlighted from the above state-of-the-art reviews. First, symbol spotting is concerned with various graphical documents viz. electronic documents, architectural floorplans etc., which in reality suffer from \emph{noise} that may come from various sources such as low-level image processing, intervention of text, etc. So efficiently handling structural noise is crucial for symbol spotting in documents. Second, an example application of symbol spotting is to find any symbolic object from a large amount of documents. Hence, the method should be efficient enough to handle a \emph{large database}. Third, symbol spotting is usually invoked by querying a cropped symbol from some document, which acts as a query to the system. So it implies infinite possibilities of the query symbols, and indirectly \emph{restricts the possibility of training} in the system. Finally, since symbol spotting is related to real-time applications, the method should have a \emph{low computational complexity}. We chose these five important aspects (segmentation, robustness in noise, training free, computational expenses, robustness with a large database) of symbol spotting to specify the advantages and disadvantages of the key research, which is listed in Table~ ?.

In the next chapter, we are going to propose the first symbol spotting algorithm. The method is based on the factorization of graph into serialized subgraphs (graph paths) and then organizing those graph paths into hash table. The hash based technique helps to reduce search space considerably and perform the subgraph matching (symbol spotting) faster.